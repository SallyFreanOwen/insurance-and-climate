### Note: to use this file first download data using "NL-00-test-nightlight-import.R" or [insert name of terminal code to download all NOAA tifs here]

## To install stars package:
#devtools::install_github("r-spatial/stars")

# Working with NOAA/NASA nighttime light TIFs 
library(stars)
library(dplyr)
library(sf)
library(raster)

## open night-time light TIFs individually as stars, and crop these to the NZ property extent 

## create sf object of boundary box around portfolios in NZ 
source("Scripts/EQC-02-portfolio-import.R") # if haven't already loaded eqc property data 
nzboundary <- st_bbox(portfolios)

# read in and crop first three layers, with eyeball checks: 
nl201204raw <- read_stars("Data/SVDNB_npp_20120401-20120430_00N060E_vcmcfg_v10_c201605121456.avg_rade9h.tif")
nl201204raw
nl201204 <- st_crop(x=nl201204raw, y=nzboundary, crop=TRUE, epsilon=0) #note crop takes size down from 3.3Gb to 74.5Mb - definitely worth doing first 
nl201204
rm(nl201204raw)

nl201205raw <- read_stars("Data/SVDNB_npp_20120501-20120531_00N060E_vcmcfg_v10_c201605121458.avg_rade9h.tif")
nl201205 <- st_crop(x=nl201205raw, y=nzboundary, crop=TRUE, epsilon=0)
rm(nl201205raw)

nl201206raw <- read_stars("Data/SVDNB_npp_20120601-20120630_00N060E_vcmcfg_v10_c201605121459.avg_rade9h.tif")
nl201206 <- st_crop(x=nl201206raw, y=nzboundary, crop=TRUE, epsilon=0)
rm(nl201206raw)

################

# now repeated for each .tif (read then crop, then rm raw, for ease of pulling lists)
nl201207raw <- read_stars("Data/SVDNB_npp_20120701-20120731_00N060E_vcmcfg_v10_c201605121509.avg_rade9h.tif")
nl201208raw <- read_stars("Data/SVDNB_npp_20120801-20120831_00N060E_vcmcfg_v10_c201602121348.avg_rade9h.tif")
nl201209raw <- read_stars("Data/SVDNB_npp_20120901-20120930_00N060E_vcmcfg_v10_c201602090953.avg_rade9h.tif")
nl201210raw <- read_stars("Data/SVDNB_npp_20121001-20121031_00N060E_vcmcfg_v10_c201602051401.avg_rade9h.tif")
nl201211raw <- read_stars("Data/SVDNB_npp_20121101-20121130_00N060E_vcmcfg_v10_c201601270845.avg_rade9h.tif")
nl201212raw <- read_stars("Data/SVDNB_npp_20121201-20121231_00N060E_vcmcfg_v10_c201601041440.avg_rade9h.tif")
nl201301raw <- read_stars("Data/SVDNB_npp_20130101-20130131_00N060E_vcmcfg_v10_c201605121529.avg_rade9h.tif")
nl201302raw <- read_stars("Data/SVDNB_npp_20130201-20130228_00N060E_vcmcfg_v10_c201605131247.avg_rade9h.tif")
nl201303raw <- read_stars("Data/SVDNB_npp_20130301-20130331_00N060E_vcmcfg_v10_c201605131250.avg_rade9h.tif")
nl201304raw <- read_stars("Data/SVDNB_npp_20130401-20130430_00N060E_vcmcfg_v10_c201605131251.avg_rade9h.tif")
nl201305raw <- read_stars("Data/SVDNB_npp_20130501-20130531_00N060E_vcmcfg_v10_c201605131256.avg_rade9h.tif")
nl201306raw <- read_stars("Data/SVDNB_npp_20130601-20130630_00N060E_vcmcfg_v10_c201605131304.avg_rade9h.tif")
nl201307raw <- read_stars("Data/SVDNB_npp_20130701-20130731_00N060E_vcmcfg_v10_c201605131305.avg_rade9h.tif")
nl201308raw <- read_stars("Data/SVDNB_npp_20130801-20130831_00N060E_vcmcfg_v10_c201605131312.avg_rade9h.tif")
nl201309raw <- read_stars("Data/SVDNB_npp_20130901-20130930_00N060E_vcmcfg_v10_c201605131325.avg_rade9h.tif")
nl201310raw <- read_stars("Data/SVDNB_npp_20131001-20131031_00N060E_vcmcfg_v10_c201605131331.avg_rade9h.tif")
nl201311raw <- read_stars("Data/SVDNB_npp_20131101-20131130_00N060E_vcmcfg_v10_c201605131332.avg_rade9h.tif")
nl201312raw <- read_stars("Data/SVDNB_npp_20131201-20131231_00N060E_vcmcfg_v10_c201605131341.avg_rade9h.tif")
nl201401raw <- read_stars("Data/SVDNB_npp_20140101-20140131_00N060E_vcmcfg_v10_c201506171538.avg_rade9h.tif")
nl201402raw <- read_stars("Data/SVDNB_npp_20140201-20140228_00N060E_vcmcfg_v10_c201507201052.avg_rade9h.tif")
nl201403raw <- read_stars("Data/SVDNB_npp_20140301-20140331_00N060E_vcmcfg_v10_c201506121552.avg_rade9h.tif")
nl201404raw <- read_stars("Data/SVDNB_npp_20140401-20140430_00N060E_vcmcfg_v10_c201507201613.avg_rade9h.tif")
nl201405raw <- read_stars("Data/SVDNB_npp_20140501-20140531_00N060E_vcmcfg_v10_c201502061154.avg_rade9h.tif")
nl201406raw <- read_stars("Data/SVDNB_npp_20140601-20140630_00N060E_vcmcfg_v10_c201502121156.avg_rade9h.tif")
nl201407raw <- read_stars("Data/SVDNB_npp_20140701-20140731_00N060E_vcmcfg_v10_c201506231100.avg_rade9h.tif")
nl201408raw <- read_stars("Data/SVDNB_npp_20140801-20140831_00N060E_vcmcfg_v10_c201508131459.avg_rade9h.tif")
nl201409raw <- read_stars("Data/SVDNB_npp_20140901-20140930_00N060E_vcmcfg_v10_c201502251400.avg_rade9h.tif")
nl201410raw <- read_stars("Data/SVDNB_npp_20141001-20141031_00N060E_vcmcfg_v10_c201502231115.avg_rade9h.tif")
nl201411raw <- read_stars("Data/SVDNB_npp_20141101-20141130_00N060E_vcmcfg_v10_c201502231455.avg_rade9h.tif")
nl201412raw <- read_stars("Data/SVDNB_npp_20141201-20141231_00N060E_vcmcfg_v10_c201502231125.avg_rade9h.tif")
nl201501raw <- read_stars("Data/SVDNB_npp_20150101-20150131_00N060E_vcmcfg_v10_c201505111709.avg_rade9h.tif")
nl201502raw <- read_stars("Data/SVDNB_npp_20150201-20150228_00N060E_vcmcfg_v10_c201504281504.avg_rade9h.tif")
nl201503raw <- read_stars("Data/SVDNB_npp_20150301-20150331_00N060E_vcmcfg_v10_c201505191916.avg_rade9h.tif")
nl201504raw <- read_stars("Data/SVDNB_npp_20150401-20150430_00N060E_vcmcfg_v10_c201506011707.avg_rade9h.tif")
nl201505raw <- read_stars("Data/SVDNB_npp_20150501-20150531_00N060E_vcmcfg_v10_c201506161325.avg_rade9h.tif")
nl201506raw <- read_stars("Data/SVDNB_npp_20150601-20150630_00N060E_vcmcfg_v10_c201508141522.avg_rade9h.tif")
nl201507raw <- read_stars("Data/SVDNB_npp_20150701-20150731_00N060E_vcmcfg_v10_c201509151839.avg_rade9h.tif")
nl201508raw <- read_stars("Data/SVDNB_npp_20150801-20150831_00N060E_vcmcfg_v10_c201509301759.avg_rade9h.tif")
nl201509raw <- read_stars("Data/SVDNB_npp_20150901-20150930_00N060E_vcmcfg_v10_c201511121210.avg_rade9h.tif")
nl201510raw <- read_stars("Data/SVDNB_npp_20151001-20151031_00N060E_vcmcfg_v10_c201511181404.avg_rade9h.tif")
nl201511raw <- read_stars("Data/SVDNB_npp_20151101-20151130_00N060E_vcmcfg_v10_c201512121648.avg_rade9h.tif")
nl201512raw <- read_stars("Data/SVDNB_npp_20151201-20151231_00N060E_vcmcfg_v10_c201601251413.avg_rade9h.tif")
nl201601raw <- read_stars("Data/SVDNB_npp_20160101-20160131_00N060E_vcmcfg_v10_c201603132032.avg_rade9h.tif")
nl201602raw <- read_stars("Data/SVDNB_npp_20160201-20160229_00N060E_vcmcfg_v10_c201603152010.avg_rade9h.tif")
nl201603raw <- read_stars("Data/SVDNB_npp_20160301-20160331_00N060E_vcmcfg_v10_c201604191144.avg_rade9h.tif")
nl201604raw <- read_stars("Data/SVDNB_npp_20160401-20160430_00N060E_vcmcfg_v10_c201606140957.avg_rade9h.tif")
nl201605raw <- read_stars("Data/SVDNB_npp_20160501-20160531_00N060E_vcmcfg_v10_c201606281430.avg_rade9h.tif")
nl201606raw <- read_stars("Data/SVDNB_npp_20160601-20160630_00N060E_vcmcfg_v10_c201608101832.avg_rade9h.tif")
nl201607raw <- read_stars("Data/SVDNB_npp_20160701-20160731_00N060E_vcmcfg_v10_c201609121310.avg_rade9h.tif")
nl201608raw <- read_stars("Data/SVDNB_npp_20160801-20160831_00N060E_vcmcfg_v10_c201610041107.avg_rade9h.tif")
nl201609raw <- read_stars("Data/SVDNB_npp_20160901-20160930_00N060E_vcmcfg_v10_c201610280941.avg_rade9h.tif")
nl201610raw <- read_stars("Data/SVDNB_npp_20161001-20161031_00N060E_vcmcfg_v10_c201612011122.avg_rade9h.tif")
nl201611raw <- read_stars("Data/SVDNB_npp_20161101-20161130_00N060E_vcmcfg_v10_c201612191231.avg_rade9h.tif")
nl201612raw <- read_stars("Data/SVDNB_npp_20161201-20161231_00N060E_vcmcfg_v10_c201701271136.avg_rade9h.tif")
nl201701raw <- read_stars("Data/SVDNB_npp_20170101-20170131_00N060E_vcmcfg_v10_c201702241223.avg_rade9h.tif")
nl201702raw <- read_stars("Data/SVDNB_npp_20170201-20170228_00N060E_vcmcfg_v10_c201703012030.avg_rade9h.tif")
nl201703raw <- read_stars("Data/SVDNB_npp_20170301-20170331_00N060E_vcmcfg_v10_c201705020851.avg_rade9h.tif")
nl201704raw <- read_stars("Data/SVDNB_npp_20170401-20170430_00N060E_vcmcfg_v10_c201705011300.avg_rade9h.tif")
nl201705raw <- read_stars("Data/SVDNB_npp_20170501-20170531_00N060E_vcmcfg_v10_c201706021500.avg_rade9h.tif")
nl201706raw <- read_stars("Data/SVDNB_npp_20170601-20170630_00N060E_vcmcfg_v10_c201707021700.avg_rade9h.tif")
nl201707raw <- read_stars("Data/SVDNB_npp_20170701-20170731_00N060E_vcmcfg_v10_c201708061230.avg_rade9h.tif")
nl201708raw <- read_stars("Data/SVDNB_npp_20170801-20170831_00N060E_vcmcfg_v10_c201709051000.avg_rade9h.tif")
nl201709raw <- read_stars("Data/SVDNB_npp_20170901-20170930_00N060E_vcmcfg_v10_c201710041620.avg_rade9h.tif")
nl201710raw <- read_stars("Data/SVDNB_npp_20171001-20171031_00N060E_vcmcfg_v10_c201711021230.avg_rade9h.tif")
nl201711raw <- read_stars("Data/SVDNB_npp_20171101-20171130_00N060E_vcmcfg_v10_c201712040930.avg_rade9h.tif")
nl201712raw <- read_stars("Data/SVDNB_npp_20171201-20171231_00N060E_vcmcfg_v10_c201801021747.avg_rade9h.tif")
nl201801raw <- read_stars("Data/SVDNB_npp_20180101-20180131_00N060E_vcmcfg_v10_c201805221252.avg_rade9h.tif")
nl201802raw <- read_stars("Data/SVDNB_npp_20180201-20180228_00N060E_vcmcfg_v10_c201803012000.avg_rade9h.tif")
nl201803raw <- read_stars("Data/SVDNB_npp_20180301-20180331_00N060E_vcmcfg_v10_c201804022005.avg_rade9h.tif")
nl201804raw <- read_stars("Data/SVDNB_npp_20180401-20180430_00N060E_vcmcfg_v10_c201805021400.avg_rade9h.tif")
nl201805raw <- read_stars("Data/SVDNB_npp_20180501-20180531_00N060E_vcmcfg_v10_c201806061100.avg_rade9h.tif")
nl201808raw <- read_stars("Data/SVDNB_npp_20180801-20180831_00N060E_vcmcfg_v10_c201809070900.avg_rade9h.tif")
nl201809raw <- read_stars("Data/SVDNB_npp_20180901-20180930_00N060E_vcmcfg_v10_c201810250900.avg_rade9h.tif")
nl201810raw <- read_stars("Data/SVDNB_npp_20181001-20181031_00N060E_vcmcfg_v10_c201811131000.avg_rade9h.tif")

nl201206 <- st_crop(x=nl201206raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201207 <- st_crop(x=nl201207raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201208 <- st_crop(x=nl201208raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201209 <- st_crop(x=nl201209raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201210 <- st_crop(x=nl201210raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201211 <- st_crop(x=nl201211raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201212 <- st_crop(x=nl201212raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201301 <- st_crop(x=nl201301raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201302 <- st_crop(x=nl201302raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201303 <- st_crop(x=nl201303raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201304 <- st_crop(x=nl201304raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201305 <- st_crop(x=nl201305raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201306 <- st_crop(x=nl201306raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201307 <- st_crop(x=nl201307raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201308 <- st_crop(x=nl201308raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201309 <- st_crop(x=nl201309raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201310 <- st_crop(x=nl201310raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201311 <- st_crop(x=nl201311raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201312 <- st_crop(x=nl201312raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201401 <- st_crop(x=nl201401raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201402 <- st_crop(x=nl201402raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201403 <- st_crop(x=nl201403raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201404 <- st_crop(x=nl201404raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201405 <- st_crop(x=nl201405raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201406 <- st_crop(x=nl201406raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201407 <- st_crop(x=nl201407raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201408 <- st_crop(x=nl201408raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201409 <- st_crop(x=nl201409raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201410 <- st_crop(x=nl201410raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201411 <- st_crop(x=nl201411raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201412 <- st_crop(x=nl201412raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201501 <- st_crop(x=nl201501raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201502 <- st_crop(x=nl201502raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201503 <- st_crop(x=nl201503raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201504 <- st_crop(x=nl201504raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201505 <- st_crop(x=nl201505raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201506 <- st_crop(x=nl201506raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201507 <- st_crop(x=nl201507raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201508 <- st_crop(x=nl201508raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201509 <- st_crop(x=nl201509raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201510 <- st_crop(x=nl201510raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201511 <- st_crop(x=nl201511raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201512 <- st_crop(x=nl201512raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201601 <- st_crop(x=nl201601raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201602 <- st_crop(x=nl201602raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201603 <- st_crop(x=nl201603raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201604 <- st_crop(x=nl201604raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201605 <- st_crop(x=nl201605raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201606 <- st_crop(x=nl201606raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201607 <- st_crop(x=nl201607raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201608 <- st_crop(x=nl201608raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201609 <- st_crop(x=nl201609raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201610 <- st_crop(x=nl201610raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201611 <- st_crop(x=nl201611raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201612 <- st_crop(x=nl201612raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201701 <- st_crop(x=nl201701raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201702 <- st_crop(x=nl201702raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201703 <- st_crop(x=nl201703raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201704 <- st_crop(x=nl201704raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201705 <- st_crop(x=nl201705raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201706 <- st_crop(x=nl201706raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201707 <- st_crop(x=nl201707raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201708 <- st_crop(x=nl201708raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201709 <- st_crop(x=nl201709raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201710 <- st_crop(x=nl201710raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201711 <- st_crop(x=nl201711raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201712 <- st_crop(x=nl201712raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201801 <- st_crop(x=nl201801raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201802 <- st_crop(x=nl201802raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201803 <- st_crop(x=nl201803raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201804 <- st_crop(x=nl201804raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201805 <- st_crop(x=nl201805raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201808 <- st_crop(x=nl201808raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201809 <- st_crop(x=nl201809raw, y=nzboundary, crop=TRUE, epsilon=0)
nl201810 <- st_crop(x=nl201810raw, y=nzboundary, crop=TRUE, epsilon=0)

rm(nl201207raw)
rm(nl201208raw)
rm(nl201209raw)
rm(nl201210raw)
rm(nl201211raw)
rm(nl201212raw)
rm(nl201301raw)
rm(nl201302raw)
rm(nl201303raw)
rm(nl201304raw)
rm(nl201305raw)
rm(nl201306raw)
rm(nl201307raw)
rm(nl201308raw)
rm(nl201309raw)
rm(nl201310raw)
rm(nl201311raw)
rm(nl201312raw)
rm(nl201401raw)
rm(nl201402raw)
rm(nl201403raw)
rm(nl201404raw)
rm(nl201405raw)
rm(nl201406raw)
rm(nl201407raw)
rm(nl201408raw)
rm(nl201409raw)
rm(nl201410raw)
rm(nl201411raw)
rm(nl201412raw)
rm(nl201501raw)
rm(nl201502raw)
rm(nl201503raw)
rm(nl201504raw)
rm(nl201505raw)
rm(nl201506raw)
rm(nl201507raw)
rm(nl201508raw)
rm(nl201509raw)
rm(nl201510raw)
rm(nl201511raw)
rm(nl201512raw)
rm(nl201601raw)
rm(nl201602raw)
rm(nl201603raw)
rm(nl201604raw)
rm(nl201605raw)
rm(nl201606raw)
rm(nl201607raw)
rm(nl201608raw)
rm(nl201609raw)
rm(nl201610raw)
rm(nl201611raw)
rm(nl201612raw)
rm(nl201701raw)
rm(nl201702raw)
rm(nl201703raw)
rm(nl201704raw)
rm(nl201705raw)
rm(nl201706raw)
rm(nl201707raw)
rm(nl201708raw)
rm(nl201709raw)
rm(nl201710raw)
rm(nl201711raw)
rm(nl201712raw)
rm(nl201801raw)
rm(nl201802raw)
rm(nl201803raw)
rm(nl201804raw)
rm(nl201805raw)
rm(nl201808raw)
rm(nl201809raw)
rm(nl201810raw)
#################

## Now combine, keeping filenames in data, with time as a third dimension: 

## NB: at work computer I probably need to add the below before combined will work:
#memory.limit(100000)

## stars can combine the tifs and create a third dim using their filenames as the new dimension values, but taking on i=[1,n]:
nl_combined <- c(c(nl201204, nl201205, nl201206, nl201207, nl201208, nl201209, nl201210, nl201211, nl201212, 
                   nl201301, nl201302, nl201303, nl201304, nl201305, nl201306, nl201307, nl201308, nl201309, nl201310, nl201311, nl201312, 
                   nl201401, nl201402, nl201403, nl201404, nl201405, nl201406, nl201407, nl201408, nl201409, nl201410, nl201411, nl201412, 
                   nl201501, nl201502, nl201503, nl201504, nl201505, nl201506, nl201507, nl201508, nl201509, nl201510, nl201511, nl201512, 
                   nl201601, nl201602, nl201603, nl201604, nl201605, nl201606, nl201607, nl201608, nl201609, nl201610, nl201611, nl201612, 
                   nl201701, nl201702, nl201703, nl201704, nl201705, nl201706, nl201707, nl201708, nl201709, nl201710, nl201711, nl201712, 
                   nl201801, nl201802, nl201803, nl201804, nl201805, nl201808, nl201809, nl201810))
#eyeball combined:
nl_combined 

#eventually, here add in other layers (monthly to present)

## change newdimname to time 
dimnames(nl_combined)[3]<-"time"


## crop to NZ boundary box 
#individually:
nl_combined <- st_crop(x=nl_combined, y=nzboundary, crop=TRUE, epsilon=0)

## 

# next steps here:
# crop individually before combine
# add other NL layers to script 